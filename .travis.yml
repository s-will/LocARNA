sudo: false
language: cpp
compiler:
  - gcc
  - clang

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - gcc-4.8
    - g++-4.8
    - clang
    - help2man
    - libgsl0-dev

install:
  - if [ "$CXX" = "g++" ]; then export CXX="g++-4.8" CC="gcc-4.8"; fi

  # install conda to install viennarna
  - wget http://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
  - chmod +x miniconda.sh
  - "./miniconda.sh -b"
  - export CONDA_PATH=$HOME/miniconda3
  - export PATH=$CONDA_PATH/bin:$PATH
  - export CONDA_LIB_PATH=$CONDA_PATH/lib
  - conda update --yes conda
  - conda install --yes -c bioconda viennarna

  # don't use libc++ for now
  # - if [ "$CXX" == "clang++" ]; then export CXXFLAGS="--stdlib=libc++" ; fi

before_script:
  - autoreconf -i

script: ./configure --with-vrna=$CONDA_PATH && make -j${CPU_COUNT} && make -j${CPU_COUNT} check
