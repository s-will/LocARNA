<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LocARNA-2.0.0RC10: LocARNA::RnaDataImpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LocARNA-2.0.0RC10
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceLocARNA.html">LocARNA</a></li><li class="navelem"><a class="el" href="classLocARNA_1_1RnaDataImpl.html">RnaDataImpl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classLocARNA_1_1RnaDataImpl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">LocARNA::RnaDataImpl Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of <a class="el" href="classLocARNA_1_1RnaData.html" title="represent sparsified data of RNA ensemble">RnaData</a>.  
 <a href="classLocARNA_1_1RnaDataImpl.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rna__data__impl_8hh_source.html">rna_data_impl.hh</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for LocARNA::RnaDataImpl:</div>
<div class="dyncontent">
<div class="center"><img src="classLocARNA_1_1RnaDataImpl__coll__graph.png" border="0" usemap="#aLocARNA_1_1RnaDataImpl_coll__map" alt="Collaboration graph"/></div>
<map name="aLocARNA_1_1RnaDataImpl_coll__map" id="aLocARNA_1_1RnaDataImpl_coll__map">
<area shape="rect" title="Implementation of RnaData." alt="" coords="935,78,1101,105"/>
<area shape="rect" href="classLocARNA_1_1RnaData.html" title="represent sparsified data of RNA ensemble" alt="" coords="637,14,779,41"/>
<area shape="rect" title=" " alt="" coords="284,5,463,47"/>
<area shape="rect" href="classLocARNA_1_1SparseMatrix.html" title=" " alt="" coords="625,71,791,112"/>
<area shape="rect" href="classLocARNA_1_1SparseVectorBase.html" title="Base class template for sparse vector and matrix." alt="" coords="264,71,483,112"/>
<area shape="rect" title=" " alt="" coords="5,71,155,112"/>
<area shape="rect" href="classLocARNA_1_1MultipleAlignment.html" title="Represents a multiple alignment." alt="" coords="612,137,804,163"/>
<area shape="rect" title=" " alt="" coords="291,137,456,163"/>
<area shape="rect" title=" " alt="" coords="285,187,462,214"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl_1_1keyvec.html">keyvec</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ac89923b11742e931b9b1cd235dfbf133"><td class="memItemLeft" align="right" valign="top"><a id="ac89923b11742e931b9b1cd235dfbf133"></a>
typedef <a class="el" href="classLocARNA_1_1RnaData.html#a149b89b595d4e54dd7414718653571f6">RnaData::arc_prob_matrix_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ac89923b11742e931b9b1cd235dfbf133">arc_prob_matrix_t</a></td></tr>
<tr class="memdesc:ac89923b11742e931b9b1cd235dfbf133"><td class="mdescLeft">&#160;</td><td class="mdescRight">type for matrix of arc probabilities <br /></td></tr>
<tr class="separator:ac89923b11742e931b9b1cd235dfbf133"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab38e4c587aae2b8d46aa7a8c17d4782c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ab38e4c587aae2b8d46aa7a8c17d4782c">RnaDataImpl</a> (<a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> *self, const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;rna_dataA, const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;rna_dataB, const <a class="el" href="classLocARNA_1_1Alignment.html#a6537d524c8ac35dbf37ed46fd671d2ef">Alignment::edges_t</a> &amp;alignment, double p_expA, double p_expB)</td></tr>
<tr class="memdesc:ab38e4c587aae2b8d46aa7a8c17d4782c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct as consensus of two aligned RNAs.  <a href="classLocARNA_1_1RnaDataImpl.html#ab38e4c587aae2b8d46aa7a8c17d4782c">More...</a><br /></td></tr>
<tr class="separator:ab38e4c587aae2b8d46aa7a8c17d4782c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc88c59c9ae7bb2ad57c43eb381e086f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#afc88c59c9ae7bb2ad57c43eb381e086f">RnaDataImpl</a> (<a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> *self, double p_bpcut, size_t max_bp_span)</td></tr>
<tr class="memdesc:afc88c59c9ae7bb2ad57c43eb381e086f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Almost empty constructor.  <a href="classLocARNA_1_1RnaDataImpl.html#afc88c59c9ae7bb2ad57c43eb381e086f">More...</a><br /></td></tr>
<tr class="separator:afc88c59c9ae7bb2ad57c43eb381e086f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc571f6c345e946502b3f314ca402fe0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#abc571f6c345e946502b3f314ca402fe0">init_from_fixed_structure</a> (const <a class="el" href="classLocARNA_1_1RnaStructure.html">RnaStructure</a> &amp;structure, const <a class="el" href="classLocARNA_1_1PFoldParams.html">PFoldParams</a> &amp;pfoldparams)</td></tr>
<tr class="memdesc:abc571f6c345e946502b3f314ca402fe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize from fixed structure  <a href="classLocARNA_1_1RnaDataImpl.html#abc571f6c345e946502b3f314ca402fe0">More...</a><br /></td></tr>
<tr class="separator:abc571f6c345e946502b3f314ca402fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5aff6f77631912da5cd3d4f0cd98dfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#aa5aff6f77631912da5cd3d4f0cd98dfb">init_from_rna_ensemble</a> (const <a class="el" href="classLocARNA_1_1RnaEnsemble.html">RnaEnsemble</a> &amp;rna_ensemble, const <a class="el" href="classLocARNA_1_1PFoldParams.html">PFoldParams</a> &amp;pfoldparams)</td></tr>
<tr class="memdesc:aa5aff6f77631912da5cd3d4f0cd98dfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize from rna ensemble  <a href="classLocARNA_1_1RnaDataImpl.html#aa5aff6f77631912da5cd3d4f0cd98dfb">More...</a><br /></td></tr>
<tr class="separator:aa5aff6f77631912da5cd3d4f0cd98dfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bba71ca3df4d1f164a01c669696adc4"><td class="memItemLeft" align="right" valign="top">std::istream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#a3bba71ca3df4d1f164a01c669696adc4">read_pp_sequence</a> (std::istream &amp;in)</td></tr>
<tr class="memdesc:a3bba71ca3df4d1f164a01c669696adc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">read sequence section of pp-format  <a href="classLocARNA_1_1RnaDataImpl.html#a3bba71ca3df4d1f164a01c669696adc4">More...</a><br /></td></tr>
<tr class="separator:a3bba71ca3df4d1f164a01c669696adc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab559b61b14a1beb22434f87dc92abd9e"><td class="memItemLeft" align="right" valign="top">std::istream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ab559b61b14a1beb22434f87dc92abd9e">read_pp_arc_probabilities</a> (std::istream &amp;in)</td></tr>
<tr class="memdesc:ab559b61b14a1beb22434f87dc92abd9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">read section of base pair probabilities of pp-format  <a href="classLocARNA_1_1RnaDataImpl.html#ab559b61b14a1beb22434f87dc92abd9e">More...</a><br /></td></tr>
<tr class="separator:ab559b61b14a1beb22434f87dc92abd9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c3fb71a9ef3192f086926dd3110182"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ad8c3fb71a9ef3192f086926dd3110182">write_pp_sequence</a> (std::ostream &amp;out) const</td></tr>
<tr class="memdesc:ad8c3fb71a9ef3192f086926dd3110182"><td class="mdescLeft">&#160;</td><td class="mdescRight">write section of base pair probabilities of pp-format  <a href="classLocARNA_1_1RnaDataImpl.html#ad8c3fb71a9ef3192f086926dd3110182">More...</a><br /></td></tr>
<tr class="separator:ad8c3fb71a9ef3192f086926dd3110182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a501cf567528314efff7ecd9a4023bae3"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#a501cf567528314efff7ecd9a4023bae3">write_pp_arc_probabilities</a> (std::ostream &amp;out, double p_outbpcut, bool stacking) const</td></tr>
<tr class="memdesc:a501cf567528314efff7ecd9a4023bae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">write section of base pair probabilities of pp-format  <a href="classLocARNA_1_1RnaDataImpl.html#a501cf567528314efff7ecd9a4023bae3">More...</a><br /></td></tr>
<tr class="separator:a501cf567528314efff7ecd9a4023bae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac215e32aa52480e4d97197a4c15ef1b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ac215e32aa52480e4d97197a4c15ef1b8">init_as_consensus_dot_plot</a> (const <a class="el" href="classLocARNA_1_1Alignment.html#a6537d524c8ac35dbf37ed46fd671d2ef">Alignment::edges_t</a> &amp;edges, const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;rna_dataA, const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;rna_dataB, double p_expA, double p_expB, double f_penalty, bool stacking)</td></tr>
<tr class="memdesc:ac215e32aa52480e4d97197a4c15ef1b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize as consensus of two aligned RNAs.  <a href="classLocARNA_1_1RnaDataImpl.html#ac215e32aa52480e4d97197a4c15ef1b8">More...</a><br /></td></tr>
<tr class="separator:ac215e32aa52480e4d97197a4c15ef1b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b10f572e01a53b2cd98806379e2b522"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#a6b10f572e01a53b2cd98806379e2b522">consensus_probability</a> (double pA, double pB, size_t sizeA, size_t sizeB, double p_expA, double p_expB, double p_penalty) const</td></tr>
<tr class="memdesc:a6b10f572e01a53b2cd98806379e2b522"><td class="mdescLeft">&#160;</td><td class="mdescRight">Consensus probability.  <a href="classLocARNA_1_1RnaDataImpl.html#a6b10f572e01a53b2cd98806379e2b522">More...</a><br /></td></tr>
<tr class="separator:a6b10f572e01a53b2cd98806379e2b522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa44ff0244f55f111612f3746072bb03e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#aa44ff0244f55f111612f3746072bb03e">drop_worst_bps</a> (size_t keep)</td></tr>
<tr class="memdesc:aa44ff0244f55f111612f3746072bb03e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drop base pairs with lowest probability.  <a href="classLocARNA_1_1RnaDataImpl.html#aa44ff0244f55f111612f3746072bb03e">More...</a><br /></td></tr>
<tr class="separator:aa44ff0244f55f111612f3746072bb03e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:aa048f786cf911ef98495c2c9eee6084d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#aa048f786cf911ef98495c2c9eee6084d">self_</a></td></tr>
<tr class="separator:aa048f786cf911ef98495c2c9eee6084d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a738462fc2f3b9b034be615dc98c45120"><td class="memItemLeft" align="right" valign="top"><a id="a738462fc2f3b9b034be615dc98c45120"></a>
<a class="el" href="classLocARNA_1_1MultipleAlignment.html">MultipleAlignment</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#a738462fc2f3b9b034be615dc98c45120">sequence_</a></td></tr>
<tr class="memdesc:a738462fc2f3b9b034be615dc98c45120"><td class="mdescLeft">&#160;</td><td class="mdescRight">the sequence <br /></td></tr>
<tr class="separator:a738462fc2f3b9b034be615dc98c45120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a402ab970e037f2eb31c00179ff24ab78"><td class="memItemLeft" align="right" valign="top"><a id="a402ab970e037f2eb31c00179ff24ab78"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#a402ab970e037f2eb31c00179ff24ab78">p_bpcut_</a></td></tr>
<tr class="memdesc:a402ab970e037f2eb31c00179ff24ab78"><td class="mdescLeft">&#160;</td><td class="mdescRight">cutoff probabilitiy for base pair <br /></td></tr>
<tr class="separator:a402ab970e037f2eb31c00179ff24ab78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86438a673a1c3c87a122707564510a84"><td class="memItemLeft" align="right" valign="top"><a id="a86438a673a1c3c87a122707564510a84"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>max_bp_span_</b></td></tr>
<tr class="separator:a86438a673a1c3c87a122707564510a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58d767db1dc59c45bbe00bf73ae5c34e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ac89923b11742e931b9b1cd235dfbf133">arc_prob_matrix_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#a58d767db1dc59c45bbe00bf73ae5c34e">arc_probs_</a></td></tr>
<tr class="separator:a58d767db1dc59c45bbe00bf73ae5c34e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b07eeccbf607bdcb55128ace3b1629"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ac89923b11742e931b9b1cd235dfbf133">arc_prob_matrix_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#af8b07eeccbf607bdcb55128ace3b1629">arc_2_probs_</a></td></tr>
<tr class="separator:af8b07eeccbf607bdcb55128ace3b1629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e89c6ddf5cc72c00ac06dd22082176b"><td class="memItemLeft" align="right" valign="top"><a id="a8e89c6ddf5cc72c00ac06dd22082176b"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#a8e89c6ddf5cc72c00ac06dd22082176b">has_stacking_</a></td></tr>
<tr class="memdesc:a8e89c6ddf5cc72c00ac06dd22082176b"><td class="mdescLeft">&#160;</td><td class="mdescRight">whether stacking probabilities are available <br /></td></tr>
<tr class="separator:a8e89c6ddf5cc72c00ac06dd22082176b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of <a class="el" href="classLocARNA_1_1RnaData.html" title="represent sparsified data of RNA ensemble">RnaData</a>. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab38e4c587aae2b8d46aa7a8c17d4782c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab38e4c587aae2b8d46aa7a8c17d4782c">&#9670;&nbsp;</a></span>RnaDataImpl() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LocARNA::RnaDataImpl::RnaDataImpl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td>
          <td class="paramname"><em>rna_dataA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td>
          <td class="paramname"><em>rna_dataB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Alignment.html#a6537d524c8ac35dbf37ed46fd671d2ef">Alignment::edges_t</a> &amp;&#160;</td>
          <td class="paramname"><em>alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_expA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_expB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct as consensus of two aligned RNAs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>pointer to corresponding <a class="el" href="classLocARNA_1_1RnaData.html" title="represent sparsified data of RNA ensemble">RnaData</a> object </td></tr>
    <tr><td class="paramname">rna_dataA</td><td>data of RNA A </td></tr>
    <tr><td class="paramname">rna_dataB</td><td>data of RNA B </td></tr>
    <tr><td class="paramname">alignment</td><td>pairwise alignment of A and B </td></tr>
    <tr><td class="paramname">p_expA</td><td>background probability A </td></tr>
    <tr><td class="paramname">p_expB</td><td>background probability B </td></tr>
  </table>
  </dd>
</dl>
<p>&lt;  </p>

</div>
</div>
<a id="afc88c59c9ae7bb2ad57c43eb381e086f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc88c59c9ae7bb2ad57c43eb381e086f">&#9670;&nbsp;</a></span>RnaDataImpl() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LocARNA::RnaDataImpl::RnaDataImpl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_bpcut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_bp_span</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Almost empty constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>pointer to corresponding <a class="el" href="classLocARNA_1_1RnaData.html" title="represent sparsified data of RNA ensemble">RnaData</a> object </td></tr>
    <tr><td class="paramname">p_bpcut</td><td>cutoff probability </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6b10f572e01a53b2cd98806379e2b522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b10f572e01a53b2cd98806379e2b522">&#9670;&nbsp;</a></span>consensus_probability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double LocARNA::RnaDataImpl::consensus_probability </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sizeA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sizeB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_expA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_expB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_penalty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Consensus probability. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pA</td><td>probability A </td></tr>
    <tr><td class="paramname">pB</td><td>probability B </td></tr>
    <tr><td class="paramname">sizeA</td><td>number of rows in sequence A </td></tr>
    <tr><td class="paramname">sizeB</td><td>number of rows in sequence B </td></tr>
    <tr><td class="paramname">p_expA</td><td>background probability A </td></tr>
    <tr><td class="paramname">p_expB</td><td>background probability B </td></tr>
    <tr><td class="paramname">p_penalty</td><td>penalty probability for base pairs with probability below cutoff</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Essentially the consensus base pair probabilities are geometric means of the combined single base pair probabilties. This is maintained by weighting the pairwise consensus computations with the respective numbers of sequences.</dd></dl>
<p>The penalty probability p_penalty has to be chosen carefully: Assuming 0 probability for base pairs below of the threshold geometric mean would result in 0 as consensus probability; thus we assume p_penalty in this case, however too high p_penalty leads to the accumulation of many base pairs with small probabilities.</p>
<p>Reasonably, p_penalty must be a small fraction of p_cutoff_.</p>
<dl class="section return"><dt>Returns</dt><dd>consensus probability </dd></dl>

</div>
</div>
<a id="aa44ff0244f55f111612f3746072bb03e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa44ff0244f55f111612f3746072bb03e">&#9670;&nbsp;</a></span>drop_worst_bps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocARNA::RnaDataImpl::drop_worst_bps </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drop base pairs with lowest probability. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keep</td><td>the maximum number of base pairs to keep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac215e32aa52480e4d97197a4c15ef1b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac215e32aa52480e4d97197a4c15ef1b8">&#9670;&nbsp;</a></span>init_as_consensus_dot_plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocARNA::RnaDataImpl::init_as_consensus_dot_plot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Alignment.html#a6537d524c8ac35dbf37ed46fd671d2ef">Alignment::edges_t</a> &amp;&#160;</td>
          <td class="paramname"><em>edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td>
          <td class="paramname"><em>rna_dataA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td>
          <td class="paramname"><em>rna_dataB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_expA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_expB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f_penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stacking</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize as consensus of two aligned RNAs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">edges</td><td>alignment edges </td></tr>
    <tr><td class="paramname">rna_dataA</td><td>rna data A </td></tr>
    <tr><td class="paramname">rna_dataB</td><td>rna data B </td></tr>
    <tr><td class="paramname">p_expA</td><td>background probability A </td></tr>
    <tr><td class="paramname">p_expB</td><td>background probability B </td></tr>
    <tr><td class="paramname">f_penalty</td><td>factor for penalty probability: p_penalty = p_bpcut*f_penalty, </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classLocARNA_1_1RnaDataImpl.html#a6b10f572e01a53b2cd98806379e2b522" title="Consensus probability.">consensus_probability()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stacking</td><td>if true, stacking consensus is computed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc571f6c345e946502b3f314ca402fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc571f6c345e946502b3f314ca402fe0">&#9670;&nbsp;</a></span>init_from_fixed_structure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocARNA::RnaDataImpl::init_from_fixed_structure </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaStructure.html">RnaStructure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1PFoldParams.html">PFoldParams</a> &amp;&#160;</td>
          <td class="paramname"><em>pfoldparams</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize from fixed structure </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">structure</td><td>fixed structure </td></tr>
    <tr><td class="paramname">pfoldparams</td><td>pfold parameters; only stacking is used</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>this strictly sets the probability of all base pairs in structure to 1.0. It does not care for constraints like noLP or maxBPspan; this has to be handled by the caller! </dd></dl>

</div>
</div>
<a id="aa5aff6f77631912da5cd3d4f0cd98dfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5aff6f77631912da5cd3d4f0cd98dfb">&#9670;&nbsp;</a></span>init_from_rna_ensemble()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocARNA::RnaDataImpl::init_from_rna_ensemble </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaEnsemble.html">RnaEnsemble</a> &amp;&#160;</td>
          <td class="paramname"><em>rna_ensemble</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1PFoldParams.html">PFoldParams</a> &amp;&#160;</td>
          <td class="paramname"><em>pfoldparams</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize from rna ensemble </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rna_ensemble</td><td>rna ensemble </td></tr>
    <tr><td class="paramname">pfoldparams</td><td>folding parameters. if stacking, initialize stacking terms; if noLP, drop lonely pairs </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab559b61b14a1beb22434f87dc92abd9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab559b61b14a1beb22434f87dc92abd9e">&#9670;&nbsp;</a></span>read_pp_arc_probabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::istream &amp; LocARNA::RnaDataImpl::read_pp_arc_probabilities </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read section of base pair probabilities of pp-format </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>input stream</td></tr>
  </table>
  </dd>
</dl>
<p>Reads only base pairs with probabilities greater than p_bpcut_; reads stacking only if has_stacking_ </p>

</div>
</div>
<a id="a3bba71ca3df4d1f164a01c669696adc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bba71ca3df4d1f164a01c669696adc4">&#9670;&nbsp;</a></span>read_pp_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::istream &amp; LocARNA::RnaDataImpl::read_pp_sequence </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read sequence section of pp-format </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>input stream </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>stream</dd></dl>
<p>this section comprises sequence/multiple alignment (possibly including sequence anchor annotation) </p>

</div>
</div>
<a id="a501cf567528314efff7ecd9a4023bae3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a501cf567528314efff7ecd9a4023bae3">&#9670;&nbsp;</a></span>write_pp_arc_probabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; LocARNA::RnaDataImpl::write_pp_arc_probabilities </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_outbpcut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stacking</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write section of base pair probabilities of pp-format </p>
<p>Write arc probabilities.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>ouput stream </td></tr>
    <tr><td class="paramname">p_outbpcut</td><td>cutoff probabilitiy </td></tr>
    <tr><td class="paramname">stacking</td><td>whether to write stacking probabilities; if stacking but !has_stacking_, no stacking terms are written but flag #STACKS is written to output</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>stream</dd></dl>
<p>Write only base pairs with probabilities greater than p_outbpcut</p>
<p>Writes arc and stacking probabilities to stream; filters by probability threshold p_outbpcut </p>

</div>
</div>
<a id="ad8c3fb71a9ef3192f086926dd3110182"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c3fb71a9ef3192f086926dd3110182">&#9670;&nbsp;</a></span>write_pp_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; LocARNA::RnaDataImpl::write_pp_sequence </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write section of base pair probabilities of pp-format </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>ouput stream </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>stream </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="af8b07eeccbf607bdcb55128ace3b1629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8b07eeccbf607bdcb55128ace3b1629">&#9670;&nbsp;</a></span>arc_2_probs_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ac89923b11742e931b9b1cd235dfbf133">arc_prob_matrix_t</a> LocARNA::RnaDataImpl::arc_2_probs_</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>sparse array for all probabilities that a pair (i,j) and its immediately inner pair (i+1,j-1) are formed simultaneously above threshold; analogous to arc_probs_</p>
<dl class="section note"><dt>Note</dt><dd>arc_2_probs_ has entry (i,j) implies arc_probs_ has entry (i,j) </dd></dl>

</div>
</div>
<a id="a58d767db1dc59c45bbe00bf73ae5c34e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58d767db1dc59c45bbe00bf73ae5c34e">&#9670;&nbsp;</a></span>arc_probs_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLocARNA_1_1RnaDataImpl.html#ac89923b11742e931b9b1cd235dfbf133">arc_prob_matrix_t</a> LocARNA::RnaDataImpl::arc_probs_</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>sparse array for all arc probabilities above threshold; the array is used when reading in the probabilities and for merging probs during pp-output </p>

</div>
</div>
<a id="aa048f786cf911ef98495c2c9eee6084d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa048f786cf911ef98495c2c9eee6084d">&#9670;&nbsp;</a></span>self_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a>* LocARNA::RnaDataImpl::self_</td>
        </tr>
      </table>
</div><div class="memdoc">
<ul>
<li>pointer to corresponding non-impl object </li>
</ul>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/LocARNA/<a class="el" href="rna__data__impl_8hh_source.html">rna_data_impl.hh</a></li>
<li>src/LocARNA/rna_data.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 29 2022 16:02:22 for LocARNA-2.0.0RC10 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
