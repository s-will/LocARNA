<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LocARNA-2.0.0: LocARNA::Scoring Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LocARNA-2.0.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceLocARNA.html">LocARNA</a></li><li class="navelem"><a class="el" href="classLocARNA_1_1Scoring.html">Scoring</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classLocARNA_1_1Scoring-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">LocARNA::Scoring Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides methods for the scoring of alignments.  
 <a href="classLocARNA_1_1Scoring.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="scoring_8hh_source.html">scoring.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for LocARNA::Scoring:</div>
<div class="dyncontent">
<div class="center"><img src="classLocARNA_1_1Scoring__inherit__graph.png" border="0" usemap="#aLocARNA_1_1Scoring_inherit__map" alt="Inheritance graph"/></div>
<map name="aLocARNA_1_1Scoring_inherit__map" id="aLocARNA_1_1Scoring_inherit__map">
<area shape="rect" title="Provides methods for the scoring of alignments." alt="" coords="30,5,163,32"/>
<area shape="rect" href="classLocARNA_1_1PFScoring.html" title=" " alt="" coords="5,80,188,107"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for LocARNA::Scoring:</div>
<div class="dyncontent">
<div class="center"><img src="classLocARNA_1_1Scoring__coll__graph.png" border="0" usemap="#aLocARNA_1_1Scoring_coll__map" alt="Collaboration graph"/></div>
<map name="aLocARNA_1_1Scoring_coll__map" id="aLocARNA_1_1Scoring_coll__map">
<area shape="rect" title="Provides methods for the scoring of alignments." alt="" coords="1035,278,1168,305"/>
<area shape="rect" href="classLocARNA_1_1RnaData.html" title="represent sparsified data of RNA ensemble" alt="" coords="733,14,875,41"/>
<area shape="rect" title=" " alt="" coords="331,5,509,47"/>
<area shape="rect" href="classLocARNA_1_1MatchProbs.html" title="Provide match probabilities." alt="" coords="725,69,883,95"/>
<area shape="rect" href="classLocARNA_1_1EdgeProbs.html" title="Provides probabilities for alignment egdes (match or trace probabilities etc)." alt="" coords="343,71,497,98"/>
<area shape="rect" href="classLocARNA_1_1Matrix.html" title=" " alt="" coords="5,71,192,98"/>
<area shape="rect" href="classLocARNA_1_1ScoringParams.html" title="Parameters for scoring." alt="" coords="715,119,893,146"/>
<area shape="rect" title=" " alt="" coords="345,214,495,241"/>
<area shape="rect" href="classLocARNA_1_1ArcMatches.html" title="Maintains the relevant arc matches and their scores." alt="" coords="725,338,883,365"/>
<area shape="rect" title=" " alt="" coords="345,268,495,309"/>
<area shape="rect" href="classLocARNA_1_1AnchorConstraints.html" title="Represents anchor constraints between two sequences." alt="" coords="321,334,519,361"/>
<area shape="rect" title=" " alt="" coords="339,385,501,411"/>
<area shape="rect" href="classLocARNA_1_1ArcMatch.html" title="Represents a match of two base pairs (arc match)" alt="" coords="26,385,171,411"/>
<area shape="rect" href="classLocARNA_1_1Matrix.html" title=" " alt="" coords="324,436,516,477"/>
<area shape="rect" href="classLocARNA_1_1MatchController.html" title="abstract class that declares the method is_valid_match()" alt="" coords="329,502,511,529"/>
<area shape="rect" href="classLocARNA_1_1BasePairs.html" title="Describes sequence and structure ensemble of an RNA." alt="" coords="345,553,495,579"/>
<area shape="rect" title=" " alt="" coords="359,654,481,681"/>
<area shape="rect" href="classLocARNA_1_1Matrix.html" title=" " alt="" coords="712,389,896,415"/>
<area shape="rect" href="classLocARNA_1_1Matrix.html" title=" " alt="" coords="708,439,900,466"/>
<area shape="rect" href="classLocARNA_1_1Sequence.html" title="&quot;Sequence View&quot; of multiple alignment as array of column vectors" alt="" coords="731,647,877,674"/>
<area shape="rect" href="classLocARNA_1_1MultipleAlignment.html" title="Represents a multiple alignment." alt="" coords="324,705,516,731"/>
<area shape="rect" title=" " alt="" coords="16,679,181,706"/>
<area shape="rect" title=" " alt="" coords="10,730,187,757"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a45b343536ae79ebbbb5016566eff8f65"><td class="memItemLeft" align="right" valign="top"><a id="a45b343536ae79ebbbb5016566eff8f65"></a>
typedef <a class="el" href="classLocARNA_1_1BasePairs____Arc.html">BasePairs__Arc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a></td></tr>
<tr class="memdesc:a45b343536ae79ebbbb5016566eff8f65"><td class="mdescLeft">&#160;</td><td class="mdescRight">arc <br /></td></tr>
<tr class="separator:a45b343536ae79ebbbb5016566eff8f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a16e6d0839d85a01d7a5fd86f080ae5ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a16e6d0839d85a01d7a5fd86f080ae5ae">Scoring</a> (const <a class="el" href="classLocARNA_1_1Sequence.html">Sequence</a> &amp;<a class="el" href="classLocARNA_1_1Scoring.html#a2c22147c94d71c1f7c1aed8153bc208a">seqA</a>, const <a class="el" href="classLocARNA_1_1Sequence.html">Sequence</a> &amp;<a class="el" href="classLocARNA_1_1Scoring.html#aa772e2bef793852e1000e237d4ddf97f">seqB</a>, const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;<a class="el" href="classLocARNA_1_1Scoring.html#a08687811c48ead0432a08bdca61e26e2">rna_dataA</a>, const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;<a class="el" href="classLocARNA_1_1Scoring.html#ab9ae79551468e59a7730d45bd909b4ed">rna_dataB</a>, const <a class="el" href="classLocARNA_1_1ArcMatches.html">ArcMatches</a> &amp;<a class="el" href="classLocARNA_1_1Scoring.html#af74e3f350feaf383e964800945a6fd61">arc_matches</a>, const <a class="el" href="classLocARNA_1_1MatchProbs.html">MatchProbs</a> *<a class="el" href="classLocARNA_1_1Scoring.html#a1ceed60e164a5a82b75b7e8a20935cad">match_probs</a>, const <a class="el" href="classLocARNA_1_1ScoringParams.html">ScoringParams</a> &amp;<a class="el" href="classLocARNA_1_1Scoring.html#a199b064557a4662f2d7424d58d6a64b3">params</a>)</td></tr>
<tr class="memdesc:a16e6d0839d85a01d7a5fd86f080ae5ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">construct scoring object  <a href="classLocARNA_1_1Scoring.html#a16e6d0839d85a01d7a5fd86f080ae5ae">More...</a><br /></td></tr>
<tr class="separator:a16e6d0839d85a01d7a5fd86f080ae5ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad28463e64e9984e85d7a72d71a175d57"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ad28463e64e9984e85d7a72d71a175d57">modify_by_parameter</a> (<a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> <a class="el" href="classLocARNA_1_1Scoring.html#a96238d7678c36bb6a521c1a368e7c8ab">lambda</a>)</td></tr>
<tr class="memdesc:ad28463e64e9984e85d7a72d71a175d57"><td class="mdescLeft">&#160;</td><td class="mdescRight">modify scoring by a parameter lambda.  <a href="classLocARNA_1_1Scoring.html#ad28463e64e9984e85d7a72d71a175d57">More...</a><br /></td></tr>
<tr class="separator:ad28463e64e9984e85d7a72d71a175d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4108b89e68ccd24449be9388ae7785a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ae4108b89e68ccd24449be9388ae7785a">apply_unpaired_penalty</a> ()</td></tr>
<tr class="separator:ae4108b89e68ccd24449be9388ae7785a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96238d7678c36bb6a521c1a368e7c8ab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a96238d7678c36bb6a521c1a368e7c8ab">lambda</a> () const</td></tr>
<tr class="memdesc:a96238d7678c36bb6a521c1a368e7c8ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get factor lambda for normalized alignment.  <a href="classLocARNA_1_1Scoring.html#a96238d7678c36bb6a521c1a368e7c8ab">More...</a><br /></td></tr>
<tr class="separator:a96238d7678c36bb6a521c1a368e7c8ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9cda9b2a18fc044506c2a7efd64668"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#afe9cda9b2a18fc044506c2a7efd64668">basematch</a> (<a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a> i, <a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a> j) const</td></tr>
<tr class="memdesc:afe9cda9b2a18fc044506c2a7efd64668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score of a match of bases (without structure)  <a href="classLocARNA_1_1Scoring.html#afe9cda9b2a18fc044506c2a7efd64668">More...</a><br /></td></tr>
<tr class="separator:afe9cda9b2a18fc044506c2a7efd64668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a774b061274110b44ee18370a152c47ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a774b061274110b44ee18370a152c47ca">arcmatch</a> (const <a class="el" href="classLocARNA_1_1ArcMatch.html">ArcMatch</a> &amp;am, bool stacked=false) const</td></tr>
<tr class="memdesc:a774b061274110b44ee18370a152c47ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score of arc match, support explicit arc match scores.  <a href="classLocARNA_1_1Scoring.html#a774b061274110b44ee18370a152c47ca">More...</a><br /></td></tr>
<tr class="separator:a774b061274110b44ee18370a152c47ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af546744efbc6fd22df455aa33c62e2b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#af546744efbc6fd22df455aa33c62e2b1">arcmatch</a> (const <a class="el" href="classLocARNA_1_1BasePairs____Arc.html">BasePairs__Arc</a> &amp;arcA, const <a class="el" href="classLocARNA_1_1BasePairs____Arc.html">BasePairs__Arc</a> &amp;arcB, bool stacked=false) const</td></tr>
<tr class="memdesc:af546744efbc6fd22df455aa33c62e2b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score of arc match, given two arcs.  <a href="classLocARNA_1_1Scoring.html#af546744efbc6fd22df455aa33c62e2b1">More...</a><br /></td></tr>
<tr class="separator:af546744efbc6fd22df455aa33c62e2b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af74e3f350feaf383e964800945a6fd61"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classLocARNA_1_1ArcMatches.html">ArcMatches</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#af74e3f350feaf383e964800945a6fd61">arc_matches</a> () const</td></tr>
<tr class="separator:af74e3f350feaf383e964800945a6fd61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a988a06809a975d90df3e32aef1e67671"><td class="memTemplParams" colspan="2">template&lt;bool gapAorB&gt; </td></tr>
<tr class="memitem:a988a06809a975d90df3e32aef1e67671"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a988a06809a975d90df3e32aef1e67671">arcDel</a> (const <a class="el" href="classLocARNA_1_1BasePairs____Arc.html">BasePairs__Arc</a> &amp;arc, bool stacked=false) const</td></tr>
<tr class="memdesc:a988a06809a975d90df3e32aef1e67671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Very basic interface, score of aligning a basepair to gap.  <a href="classLocARNA_1_1Scoring.html#a988a06809a975d90df3e32aef1e67671">More...</a><br /></td></tr>
<tr class="separator:a988a06809a975d90df3e32aef1e67671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249ae84385ded673f93f0797d2face99"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a249ae84385ded673f93f0797d2face99">arcmatch_stacked</a> (const <a class="el" href="classLocARNA_1_1ArcMatch.html">ArcMatch</a> &amp;am) const</td></tr>
<tr class="memdesc:a249ae84385ded673f93f0797d2face99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score of stacked arc match.  <a href="classLocARNA_1_1Scoring.html#a249ae84385ded673f93f0797d2face99">More...</a><br /></td></tr>
<tr class="separator:a249ae84385ded673f93f0797d2face99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab78f8f2157e2dacca8e0eee7c16d313d"><td class="memTemplParams" colspan="2">template&lt;bool gapInA&gt; </td></tr>
<tr class="memitem:ab78f8f2157e2dacca8e0eee7c16d313d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ab78f8f2157e2dacca8e0eee7c16d313d">gapX</a> (<a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a> alignedToGap) const</td></tr>
<tr class="separator:ab78f8f2157e2dacca8e0eee7c16d313d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45eb9326c7add3e70fe725beda431267"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a45eb9326c7add3e70fe725beda431267">gapA</a> (<a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a> posA) const</td></tr>
<tr class="separator:a45eb9326c7add3e70fe725beda431267"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0769c82a348afb71d36bb3a4da0c33bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a0769c82a348afb71d36bb3a4da0c33bc">gapB</a> (<a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a> posB) const</td></tr>
<tr class="separator:a0769c82a348afb71d36bb3a4da0c33bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac71cc189008de81de4130c7f3241b0b"><td class="memItemLeft" align="right" valign="top"><a id="aac71cc189008de81de4130c7f3241b0b"></a>
<a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#aac71cc189008de81de4130c7f3241b0b">exclusion</a> () const</td></tr>
<tr class="memdesc:aac71cc189008de81de4130c7f3241b0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">cost of an exclusion <br /></td></tr>
<tr class="separator:aac71cc189008de81de4130c7f3241b0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad38c04897864d92901377afd3d53290e"><td class="memItemLeft" align="right" valign="top"><a id="ad38c04897864d92901377afd3d53290e"></a>
<a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ad38c04897864d92901377afd3d53290e">indel_opening</a> () const</td></tr>
<tr class="memdesc:ad38c04897864d92901377afd3d53290e"><td class="mdescLeft">&#160;</td><td class="mdescRight">cost to begin a new indel <br /></td></tr>
<tr class="separator:ad38c04897864d92901377afd3d53290e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc106f9e848b4f91d273ece3a230e09"><td class="memItemLeft" align="right" valign="top"><a id="a9fc106f9e848b4f91d273ece3a230e09"></a>
<a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a9fc106f9e848b4f91d273ece3a230e09">loop_indel_score</a> (const <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> score) const</td></tr>
<tr class="memdesc:a9fc106f9e848b4f91d273ece3a230e09"><td class="mdescLeft">&#160;</td><td class="mdescRight">multiply an score by the ratio of indel_loop/indel <br /></td></tr>
<tr class="separator:a9fc106f9e848b4f91d273ece3a230e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14955ea6c22dff680786479b0ff71e03"><td class="memItemLeft" align="right" valign="top"><a id="a14955ea6c22dff680786479b0ff71e03"></a>
<a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a14955ea6c22dff680786479b0ff71e03">indel_opening_loop</a> () const</td></tr>
<tr class="memdesc:a14955ea6c22dff680786479b0ff71e03"><td class="mdescLeft">&#160;</td><td class="mdescRight">cost to begin a new indel <br /></td></tr>
<tr class="separator:a14955ea6c22dff680786479b0ff71e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b610f1e1be03d31082d6cd4f52e59e2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a8b610f1e1be03d31082d6cd4f52e59e2">prob_exp</a> (<a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a> len) const</td></tr>
<tr class="memdesc:a8b610f1e1be03d31082d6cd4f52e59e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expected base pair probability.  <a href="classLocARNA_1_1Scoring.html#a8b610f1e1be03d31082d6cd4f52e59e2">More...</a><br /></td></tr>
<tr class="separator:a8b610f1e1be03d31082d6cd4f52e59e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3130745838e4d1f9226064fed38e3c64"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a3130745838e4d1f9226064fed38e3c64">stacking</a> () const</td></tr>
<tr class="memdesc:a3130745838e4d1f9226064fed38e3c64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query stacking flag.  <a href="classLocARNA_1_1Scoring.html#a3130745838e4d1f9226064fed38e3c64">More...</a><br /></td></tr>
<tr class="separator:a3130745838e4d1f9226064fed38e3c64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb8deb02b069247f68fc7e9beb7e3e9d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#acb8deb02b069247f68fc7e9beb7e3e9d">is_stackable_arcA</a> (const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;a) const</td></tr>
<tr class="memdesc:acb8deb02b069247f68fc7e9beb7e3e9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is arc of A stackable.  <a href="classLocARNA_1_1Scoring.html#acb8deb02b069247f68fc7e9beb7e3e9d">More...</a><br /></td></tr>
<tr class="separator:acb8deb02b069247f68fc7e9beb7e3e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ecf973604b05b55a13bb9d78429a609"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a9ecf973604b05b55a13bb9d78429a609">is_stackable_arcB</a> (const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;a) const</td></tr>
<tr class="memdesc:a9ecf973604b05b55a13bb9d78429a609"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is arc of B stackable.  <a href="classLocARNA_1_1Scoring.html#a9ecf973604b05b55a13bb9d78429a609">More...</a><br /></td></tr>
<tr class="separator:a9ecf973604b05b55a13bb9d78429a609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5e348e14fc04dae96344fd1513cbbe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a1a5e348e14fc04dae96344fd1513cbbe">is_stackable_am</a> (const <a class="el" href="classLocARNA_1_1ArcMatch.html">ArcMatch</a> &amp;am) const</td></tr>
<tr class="memdesc:a1a5e348e14fc04dae96344fd1513cbbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is arc match stackable.  <a href="classLocARNA_1_1Scoring.html#a1a5e348e14fc04dae96344fd1513cbbe">More...</a><br /></td></tr>
<tr class="separator:a1a5e348e14fc04dae96344fd1513cbbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a346715129149ba23d7e39484fcc1631d"><td class="memItemLeft" align="right" valign="top"><a id="a346715129149ba23d7e39484fcc1631d"></a>
template&lt;&gt; </td></tr>
<tr class="memitem:a346715129149ba23d7e39484fcc1631d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><b>gapX</b> (<a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a> alignedToGap) const</td></tr>
<tr class="separator:a346715129149ba23d7e39484fcc1631d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a346715129149ba23d7e39484fcc1631d"><td class="memItemLeft" align="right" valign="top"><a id="a346715129149ba23d7e39484fcc1631d"></a>
template&lt;&gt; </td></tr>
<tr class="memitem:a346715129149ba23d7e39484fcc1631d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><b>gapX</b> (<a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a> alignedToGap) const</td></tr>
<tr class="separator:a346715129149ba23d7e39484fcc1631d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad9bdd708e306abf12fa24aea3dfa5d9f"><td class="memItemLeft" align="right" valign="top"><a id="ad9bdd708e306abf12fa24aea3dfa5d9f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>precompute_sequence_identities</b> ()</td></tr>
<tr class="separator:ad9bdd708e306abf12fa24aea3dfa5d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5054144b392a5f661742bf4128a9989"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ac5054144b392a5f661742bf4128a9989">round2score</a> (double d) const</td></tr>
<tr class="memdesc:ac5054144b392a5f661742bf4128a9989"><td class="mdescLeft">&#160;</td><td class="mdescRight">Round a double to score_t.  <a href="classLocARNA_1_1Scoring.html#ac5054144b392a5f661742bf4128a9989">More...</a><br /></td></tr>
<tr class="separator:ac5054144b392a5f661742bf4128a9989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e5078668841b2b90fc1d6313bc594db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a4e5078668841b2b90fc1d6313bc594db">sigma_</a> (int i, int j) const</td></tr>
<tr class="memdesc:a4e5078668841b2b90fc1d6313bc594db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute base similarity.  <a href="classLocARNA_1_1Scoring.html#a4e5078668841b2b90fc1d6313bc594db">More...</a><br /></td></tr>
<tr class="separator:a4e5078668841b2b90fc1d6313bc594db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a227ac8972ce8de66c887ab3227e8617c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a227ac8972ce8de66c887ab3227e8617c">precompute_sigma</a> ()</td></tr>
<tr class="memdesc:a227ac8972ce8de66c887ab3227e8617c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precompute all base similarities.  <a href="classLocARNA_1_1Scoring.html#a227ac8972ce8de66c887ab3227e8617c">More...</a><br /></td></tr>
<tr class="separator:a227ac8972ce8de66c887ab3227e8617c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eaf8e0d17d1f06b4b41ae4138c64707"><td class="memItemLeft" align="right" valign="top"><a id="a4eaf8e0d17d1f06b4b41ae4138c64707"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a4eaf8e0d17d1f06b4b41ae4138c64707">precompute_gapcost</a> ()</td></tr>
<tr class="memdesc:a4eaf8e0d17d1f06b4b41ae4138c64707"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precompute the tables for gapcost. <br /></td></tr>
<tr class="separator:a4eaf8e0d17d1f06b4b41ae4138c64707"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaad679dbf51952391c0dfe2e614de51d"><td class="memItemLeft" align="right" valign="top"><a id="aaad679dbf51952391c0dfe2e614de51d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#aaad679dbf51952391c0dfe2e614de51d">precompute_weights</a> ()</td></tr>
<tr class="memdesc:aaad679dbf51952391c0dfe2e614de51d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precompute weights/stacked weights for all arcs in A and B. <br /></td></tr>
<tr class="separator:aaad679dbf51952391c0dfe2e614de51d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a124ef08e0fafbb2fd5b6bba751b82f23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a124ef08e0fafbb2fd5b6bba751b82f23">precompute_weights</a> (const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;rna_data, const <a class="el" href="classLocARNA_1_1BasePairs.html">BasePairs</a> &amp;bps, double exp_prob, std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt; &amp;weights, std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt; &amp;stack_weights)</td></tr>
<tr class="memdesc:a124ef08e0fafbb2fd5b6bba751b82f23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper for precompute_weights (does job for one rna)  <a href="classLocARNA_1_1Scoring.html#a124ef08e0fafbb2fd5b6bba751b82f23">More...</a><br /></td></tr>
<tr class="separator:a124ef08e0fafbb2fd5b6bba751b82f23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec34cfa2b08cc68e9d52e187b1e7fb2d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#aec34cfa2b08cc68e9d52e187b1e7fb2d">probToWeight</a> (double p, double <a class="el" href="classLocARNA_1_1Scoring.html#a8b610f1e1be03d31082d6cd4f52e59e2">prob_exp</a>) const</td></tr>
<tr class="memdesc:aec34cfa2b08cc68e9d52e187b1e7fb2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">convert probability to weight for scoring  <a href="classLocARNA_1_1Scoring.html#aec34cfa2b08cc68e9d52e187b1e7fb2d">More...</a><br /></td></tr>
<tr class="separator:aec34cfa2b08cc68e9d52e187b1e7fb2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a082d94ee94ec4ed47384ffe6da6a72c2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a082d94ee94ec4ed47384ffe6da6a72c2">ribosum_arcmatch_prob</a> (const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;arcA, const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;arcB) const</td></tr>
<tr class="separator:a082d94ee94ec4ed47384ffe6da6a72c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f0382b9935eb7ab18e2f68c7e3f5ff6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a7f0382b9935eb7ab18e2f68c7e3f5ff6">riboX_arcmatch_score</a> (const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;arcA, const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;arcB) const</td></tr>
<tr class="memdesc:a7f0382b9935eb7ab18e2f68c7e3f5ff6"><td class="mdescLeft">&#160;</td><td class="mdescRight">ribofit or ribosum arcmatch score contribution  <a href="classLocARNA_1_1Scoring.html#a7f0382b9935eb7ab18e2f68c7e3f5ff6">More...</a><br /></td></tr>
<tr class="separator:a7f0382b9935eb7ab18e2f68c7e3f5ff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e20f880c35895e25c0f5a715dd6fed3"><td class="memItemLeft" align="right" valign="top"><a id="a4e20f880c35895e25c0f5a715dd6fed3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a4e20f880c35895e25c0f5a715dd6fed3">subtract</a> (std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt; &amp;v, <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> x) const</td></tr>
<tr class="memdesc:a4e20f880c35895e25c0f5a715dd6fed3"><td class="mdescLeft">&#160;</td><td class="mdescRight">subtract from each element of a score_t vector v a value x <br /></td></tr>
<tr class="separator:a4e20f880c35895e25c0f5a715dd6fed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66c45251ae8083fd4f15772a3672380"><td class="memItemLeft" align="right" valign="top"><a id="ae66c45251ae8083fd4f15772a3672380"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ae66c45251ae8083fd4f15772a3672380">subtract</a> (<a class="el" href="classLocARNA_1_1Matrix.html">Matrix</a>&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt; &amp;m, <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> x) const</td></tr>
<tr class="memdesc:ae66c45251ae8083fd4f15772a3672380"><td class="mdescLeft">&#160;</td><td class="mdescRight">subtract from each element of a score_t Matrix m a value x <br /></td></tr>
<tr class="separator:ae66c45251ae8083fd4f15772a3672380"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a199b064557a4662f2d7424d58d6a64b3"><td class="memItemLeft" align="right" valign="top"><a id="a199b064557a4662f2d7424d58d6a64b3"></a>
const <a class="el" href="classLocARNA_1_1ScoringParams.html">ScoringParams</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a199b064557a4662f2d7424d58d6a64b3">params</a></td></tr>
<tr class="memdesc:a199b064557a4662f2d7424d58d6a64b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">a collection of parameters for scoring <br /></td></tr>
<tr class="separator:a199b064557a4662f2d7424d58d6a64b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc9a59d71599c475e530824a977c71de"><td class="memItemLeft" align="right" valign="top"><a id="abc9a59d71599c475e530824a977c71de"></a>
const <a class="el" href="classLocARNA_1_1ArcMatches.html">ArcMatches</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#abc9a59d71599c475e530824a977c71de">arc_matches_</a></td></tr>
<tr class="memdesc:abc9a59d71599c475e530824a977c71de"><td class="mdescLeft">&#160;</td><td class="mdescRight">arc matches <br /></td></tr>
<tr class="separator:abc9a59d71599c475e530824a977c71de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ceed60e164a5a82b75b7e8a20935cad"><td class="memItemLeft" align="right" valign="top"><a id="a1ceed60e164a5a82b75b7e8a20935cad"></a>
const <a class="el" href="classLocARNA_1_1MatchProbs.html">MatchProbs</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a1ceed60e164a5a82b75b7e8a20935cad">match_probs</a></td></tr>
<tr class="memdesc:a1ceed60e164a5a82b75b7e8a20935cad"><td class="mdescLeft">&#160;</td><td class="mdescRight">base match probabilities <br /></td></tr>
<tr class="separator:a1ceed60e164a5a82b75b7e8a20935cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08687811c48ead0432a08bdca61e26e2"><td class="memItemLeft" align="right" valign="top"><a id="a08687811c48ead0432a08bdca61e26e2"></a>
const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a08687811c48ead0432a08bdca61e26e2">rna_dataA</a></td></tr>
<tr class="memdesc:a08687811c48ead0432a08bdca61e26e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">rna data for RNA A <br /></td></tr>
<tr class="separator:a08687811c48ead0432a08bdca61e26e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ae79551468e59a7730d45bd909b4ed"><td class="memItemLeft" align="right" valign="top"><a id="ab9ae79551468e59a7730d45bd909b4ed"></a>
const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ab9ae79551468e59a7730d45bd909b4ed">rna_dataB</a></td></tr>
<tr class="memdesc:ab9ae79551468e59a7730d45bd909b4ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">rna data for RNA B <br /></td></tr>
<tr class="separator:ab9ae79551468e59a7730d45bd909b4ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c22147c94d71c1f7c1aed8153bc208a"><td class="memItemLeft" align="right" valign="top"><a id="a2c22147c94d71c1f7c1aed8153bc208a"></a>
const <a class="el" href="classLocARNA_1_1Sequence.html">Sequence</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a2c22147c94d71c1f7c1aed8153bc208a">seqA</a></td></tr>
<tr class="memdesc:a2c22147c94d71c1f7c1aed8153bc208a"><td class="mdescLeft">&#160;</td><td class="mdescRight">sequence A <br /></td></tr>
<tr class="separator:a2c22147c94d71c1f7c1aed8153bc208a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa772e2bef793852e1000e237d4ddf97f"><td class="memItemLeft" align="right" valign="top"><a id="aa772e2bef793852e1000e237d4ddf97f"></a>
const <a class="el" href="classLocARNA_1_1Sequence.html">Sequence</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#aa772e2bef793852e1000e237d4ddf97f">seqB</a></td></tr>
<tr class="memdesc:aa772e2bef793852e1000e237d4ddf97f"><td class="mdescLeft">&#160;</td><td class="mdescRight">sequence B <br /></td></tr>
<tr class="separator:aa772e2bef793852e1000e237d4ddf97f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08273c9d48adaccb7fd46b3f2e34d977"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a08273c9d48adaccb7fd46b3f2e34d977">lambda_</a></td></tr>
<tr class="separator:a08273c9d48adaccb7fd46b3f2e34d977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9177b8cb1a5cf3a4d6b5b924995020f0"><td class="memItemLeft" align="right" valign="top"><a id="a9177b8cb1a5cf3a4d6b5b924995020f0"></a>
<a class="el" href="classLocARNA_1_1Matrix.html">Matrix</a>&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a9177b8cb1a5cf3a4d6b5b924995020f0">sigma_tab</a></td></tr>
<tr class="memdesc:a9177b8cb1a5cf3a4d6b5b924995020f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">precomputed table of base match similarities <br /></td></tr>
<tr class="separator:a9177b8cb1a5cf3a4d6b5b924995020f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada4914a550b946d721eb44952ed36730"><td class="memItemLeft" align="right" valign="top"><a id="ada4914a550b946d721eb44952ed36730"></a>
std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ada4914a550b946d721eb44952ed36730">gapcost_tabA</a></td></tr>
<tr class="memdesc:ada4914a550b946d721eb44952ed36730"><td class="mdescLeft">&#160;</td><td class="mdescRight">table for gapcost in A <br /></td></tr>
<tr class="separator:ada4914a550b946d721eb44952ed36730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b8b4d648c35eb6fe1315cc563595f96"><td class="memItemLeft" align="right" valign="top"><a id="a9b8b4d648c35eb6fe1315cc563595f96"></a>
std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#a9b8b4d648c35eb6fe1315cc563595f96">gapcost_tabB</a></td></tr>
<tr class="memdesc:a9b8b4d648c35eb6fe1315cc563595f96"><td class="mdescLeft">&#160;</td><td class="mdescRight">table for gapcost in B <br /></td></tr>
<tr class="separator:a9b8b4d648c35eb6fe1315cc563595f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e10b68c032ad61d4b60fd1088bebe68"><td class="memItemLeft" align="right" valign="top"><a id="a4e10b68c032ad61d4b60fd1088bebe68"></a>
std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>weightsA</b></td></tr>
<tr class="separator:a4e10b68c032ad61d4b60fd1088bebe68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af09d318395c162137b75ce53c9d08c71"><td class="memItemLeft" align="right" valign="top"><a id="af09d318395c162137b75ce53c9d08c71"></a>
std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>weightsB</b></td></tr>
<tr class="separator:af09d318395c162137b75ce53c9d08c71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4114d7f0a33104fff3625339bf9edf6a"><td class="memItemLeft" align="right" valign="top"><a id="a4114d7f0a33104fff3625339bf9edf6a"></a>
std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>stack_weightsA</b></td></tr>
<tr class="separator:a4114d7f0a33104fff3625339bf9edf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38b56921ec38e2479dd72e8ad87b9e92"><td class="memItemLeft" align="right" valign="top"><a id="a38b56921ec38e2479dd72e8ad87b9e92"></a>
std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>stack_weightsB</b></td></tr>
<tr class="separator:a38b56921ec38e2479dd72e8ad87b9e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1c3dd90875a768104044ed9c8dc1f1"><td class="memItemLeft" align="right" valign="top"><a id="ade1c3dd90875a768104044ed9c8dc1f1"></a>
<a class="el" href="classLocARNA_1_1Matrix.html">Matrix</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocARNA_1_1Scoring.html#ade1c3dd90875a768104044ed9c8dc1f1">identity</a></td></tr>
<tr class="memdesc:ade1c3dd90875a768104044ed9c8dc1f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">sequence identities in percent <br /></td></tr>
<tr class="separator:ade1c3dd90875a768104044ed9c8dc1f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides methods for the scoring of alignments. </p>
<p>Maintains and provides the scores for the alignment of two specific Rnas. Configurable via class ScoringParams, supports the classic LocARNA-score as well as the LocARNA MEA-Score. for "Classic Score" it supports</p><ul>
<li>match/mismatch cost or RIBOSUM for bases</li>
<li>linear or affine gap cost</li>
<li>arc match scores build of arc probabilitiesmatch_probs and optionally base match contribution or RIBOSUM for the "MEA Score" it supports</li>
<li>base match/mismatch scores derived from base match probabilities</li>
<li>RIBOSUM for base and arc match contribution</li>
<li>arc match score contributions from arc probabilities</li>
<li>weighting of single score contributions</li>
</ul>
<p>The scoring class supports only characters ACGU, gap -, and N for ribosum scoring. ALL other characters are treated as unknown characters and are basically ignored. In consequence, IUPAC codes are handled badly. Even more important, for ribosum scoring, sequences have to be upper case and Ts should be converted to Us!!!</p>
<dl class="section note"><dt>Note</dt><dd>The class implements two versions of the stacking score (controlled by ScoringParams flags stacking and new_stacking. The first flag lets the class derive the arc weights for stacked arcs from the conditional probability of the base pair (i,j) if (i+1,j-1) exists. The new_stacking flag adds a log odd contribution derived from the joint probability of (i,j) and (i+1,j-1) to the weight of (i,j).</dd></dl>
<dl class="section note"><dt>Note</dt><dd>holds only pointers and references to passed objects; since no copies are made, the caller is responsible to keep the objects alive</dd>
<dd>
the set of possible arc matches is considered part of the scoring information for alignments </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a16e6d0839d85a01d7a5fd86f080ae5ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e6d0839d85a01d7a5fd86f080ae5ae">&#9670;&nbsp;</a></span>Scoring()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LocARNA::Scoring::Scoring </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>seqA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>seqB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td>
          <td class="paramname"><em>rna_dataA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td>
          <td class="paramname"><em>rna_dataB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1ArcMatches.html">ArcMatches</a> &amp;&#160;</td>
          <td class="paramname"><em>arc_matches</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1MatchProbs.html">MatchProbs</a> *&#160;</td>
          <td class="paramname"><em>match_probs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1ScoringParams.html">ScoringParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>construct scoring object </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seqA</td><td>first sequence </td></tr>
    <tr><td class="paramname">seqB</td><td>second sequence </td></tr>
    <tr><td class="paramname">rna_dataA</td><td>probability data of first sequence </td></tr>
    <tr><td class="paramname">rna_dataB</td><td>probability data of second sequence </td></tr>
    <tr><td class="paramname">arc_matches</td><td>the (significant) arc matches between the sequences </td></tr>
    <tr><td class="paramname">match_probs</td><td>pointer to base match probabilities (can be nullptr for non-mea scores) </td></tr>
    <tr><td class="paramname">params</td><td>a collection of parameters for scoring</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>caller must keep passed objects alive </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae4108b89e68ccd24449be9388ae7785a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4108b89e68ccd24449be9388ae7785a">&#9670;&nbsp;</a></span>apply_unpaired_penalty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocARNA::Scoring::apply_unpaired_penalty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>subtract the fixed unpaired_penalty from base match and base indel scores it is similar to @modify_by_parameter method Please note that the base match and gap scores of ALL bases including the paired ones will be modified! </p>

</div>
</div>
<a id="af74e3f350feaf383e964800945a6fd61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af74e3f350feaf383e964800945a6fd61">&#9670;&nbsp;</a></span>arc_matches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classLocARNA_1_1ArcMatches.html">ArcMatches</a>* LocARNA::Scoring::arc_matches </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read access to the stored arc_matches pointer </p>

</div>
</div>
<a id="a988a06809a975d90df3e32aef1e67671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a988a06809a975d90df3e32aef1e67671">&#9670;&nbsp;</a></span>arcDel()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool isA&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::arcDel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1BasePairs____Arc.html">BasePairs__Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>arc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stacked</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Very basic interface, score of aligning a basepair to gap. </p>
<dl class="section note"><dt>Note</dt><dd>gapAorB whether deleting element in A or B (true for A) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arc</td><td>the base pair </td></tr>
    <tr><td class="paramname">stacked</td><td>whether the base pair is stacked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a774b061274110b44ee18370a152c47ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a774b061274110b44ee18370a152c47ca">&#9670;&nbsp;</a></span>arcmatch() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::arcmatch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1ArcMatch.html">ArcMatch</a> &amp;&#160;</td>
          <td class="paramname"><em>am</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stacked</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score of arc match, support explicit arc match scores. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">am</td><td>arc match </td></tr>
    <tr><td class="paramname">stacked</td><td>is stacked? (optional parameter)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Score of arc match am (potentially stacked)</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This method supports explicit arc match scores. Such scores are required for the probabilistic mode of (m)locarna.</dd>
<dd>
This method should be prefered over arcmatch(const Arc &amp;arcA, const Arc &amp;arcB, bool stacked=false) unless explicit arc match scores are not needed and the use of this method would be too inefficient. </dd></dl>

</div>
</div>
<a id="af546744efbc6fd22df455aa33c62e2b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af546744efbc6fd22df455aa33c62e2b1">&#9670;&nbsp;</a></span>arcmatch() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::arcmatch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1BasePairs____Arc.html">BasePairs__Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>arcA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1BasePairs____Arc.html">BasePairs__Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>arcB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stacked</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score of arc match, given two arcs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arcA</td><td>base pair in A </td></tr>
    <tr><td class="paramname">arcB</td><td>base pair in B </td></tr>
    <tr><td class="paramname">stacked</td><td>is stacked? (optional parameter)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Score of arc match am (potentially stacked)</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This method does not support explicit arc match scores, since this would require to know the arcmatch object.</dd>
<dd>
Using this method is disallowed if arc_matches-&gt;explicit_scores()==true (This results in a run-time error if !NDEBUG). </dd></dl>

</div>
</div>
<a id="a249ae84385ded673f93f0797d2face99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a249ae84385ded673f93f0797d2face99">&#9670;&nbsp;</a></span>arcmatch_stacked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::arcmatch_stacked </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1ArcMatch.html">ArcMatch</a> &amp;&#160;</td>
          <td class="paramname"><em>am</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Score of stacked arc match. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">am</td><td>arc match</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Score of arc match am when stacked </dd></dl>

</div>
</div>
<a id="afe9cda9b2a18fc044506c2a7efd64668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe9cda9b2a18fc044506c2a7efd64668">&#9670;&nbsp;</a></span>basematch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::basematch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a>&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a>&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Score of a match of bases (without structure) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>position in A </td></tr>
    <tr><td class="paramname">j</td><td>position in B</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>score of base match i~j </dd></dl>

</div>
</div>
<a id="a45eb9326c7add3e70fe725beda431267"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45eb9326c7add3e70fe725beda431267">&#9670;&nbsp;</a></span>gapA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::gapA </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a>&#160;</td>
          <td class="paramname"><em>posA</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Score of deletion</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">posA</td><td>position in A</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>score of deletion of posA after posB </dd></dl>

</div>
</div>
<a id="a0769c82a348afb71d36bb3a4da0c33bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0769c82a348afb71d36bb3a4da0c33bc">&#9670;&nbsp;</a></span>gapB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::gapB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a>&#160;</td>
          <td class="paramname"><em>posB</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Score of insertion</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">posB</td><td>position in B</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>score of insertion of posB after posA </dd></dl>

</div>
</div>
<a id="ab78f8f2157e2dacca8e0eee7c16d313d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab78f8f2157e2dacca8e0eee7c16d313d">&#9670;&nbsp;</a></span>gapX()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool gapInA&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::gapX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a>&#160;</td>
          <td class="paramname"><em>alignedToGap</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Score of deletion</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alignedToGap</td><td>position in A or B </td></tr>
    <tr><td class="paramname">gapInA</td><td>whether symbol in A (true) or B (false) is aligned to gap</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>score of deletion : posA &lt;--&gt; posB </dd></dl>

</div>
</div>
<a id="a1a5e348e14fc04dae96344fd1513cbbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a5e348e14fc04dae96344fd1513cbbe">&#9670;&nbsp;</a></span>is_stackable_am()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LocARNA::Scoring::is_stackable_am </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1ArcMatch.html">ArcMatch</a> &amp;&#160;</td>
          <td class="paramname"><em>am</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is arc match stackable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">am</td><td>Arc match</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether stackable </dd></dl>

</div>
</div>
<a id="acb8deb02b069247f68fc7e9beb7e3e9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb8deb02b069247f68fc7e9beb7e3e9d">&#9670;&nbsp;</a></span>is_stackable_arcA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LocARNA::Scoring::is_stackable_arcA </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is arc of A stackable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Arc</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether stackable </dd></dl>

</div>
</div>
<a id="a9ecf973604b05b55a13bb9d78429a609"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ecf973604b05b55a13bb9d78429a609">&#9670;&nbsp;</a></span>is_stackable_arcB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LocARNA::Scoring::is_stackable_arcB </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is arc of B stackable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Arc</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether stackable </dd></dl>

</div>
</div>
<a id="a96238d7678c36bb6a521c1a368e7c8ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96238d7678c36bb6a521c1a368e7c8ab">&#9670;&nbsp;</a></span>lambda()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::lambda </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get factor lambda for normalized alignment. </p>
<dl class="section return"><dt>Returns</dt><dd>lambda </dd></dl>

</div>
</div>
<a id="ad28463e64e9984e85d7a72d71a175d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad28463e64e9984e85d7a72d71a175d57">&#9670;&nbsp;</a></span>modify_by_parameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocARNA::Scoring::modify_by_parameter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a>&#160;</td>
          <td class="paramname"><em>lambda</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>modify scoring by a parameter lambda. </p>
<p>Used in the computational of normalized local alignment by fractional programming in the form of the Dinkelbach algorithm. The modification is destructive. modify_by_parameter(0) results in unmodified scoring. Repeated modifications are valid. The Outcome is <em>undefined</em> when the Scoring object is used to obtain exponentiated scores (methods exp_...) as in partition function alignment.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lambda</td><td>the parameter </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a227ac8972ce8de66c887ab3227e8617c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a227ac8972ce8de66c887ab3227e8617c">&#9670;&nbsp;</a></span>precompute_sigma()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LocARNA::Scoring::precompute_sigma </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Precompute all base similarities. </p>
<p>Precomputed similarities are stored in the sigma table. </p>

</div>
</div>
<a id="a124ef08e0fafbb2fd5b6bba751b82f23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a124ef08e0fafbb2fd5b6bba751b82f23">&#9670;&nbsp;</a></span>precompute_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LocARNA::Scoring::precompute_weights </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1RnaData.html">RnaData</a> &amp;&#160;</td>
          <td class="paramname"><em>rna_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1BasePairs.html">BasePairs</a> &amp;&#160;</td>
          <td class="paramname"><em>bps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>exp_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>stack_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper for precompute_weights (does job for one rna) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rna_data</td><td>rna probability data </td></tr>
    <tr><td class="paramname">bps</td><td>base pairs </td></tr>
    <tr><td class="paramname">exp_prob</td><td>background probability </td></tr>
    <tr><td class="paramname">weights[out]</td><td>base pair score weights </td></tr>
    <tr><td class="paramname">stack_weights[out]</td><td>base pair stacking score weights </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8b610f1e1be03d31082d6cd4f52e59e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b610f1e1be03d31082d6cd4f52e59e2">&#9670;&nbsp;</a></span>prob_exp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double LocARNA::Scoring::prob_exp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceLocARNA.html#adc6caff014e7d9621f0aa488846afe0b">size_type</a>&#160;</td>
          <td class="paramname"><em>len</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Expected base pair probability. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">len</td><td>length of RNA sequence</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>expected base pair probability for sequence length</dd></dl>
<dl class="section note"><dt>Note</dt><dd>influences computation of weights for base pairs </dd></dl>

</div>
</div>
<a id="aec34cfa2b08cc68e9d52e187b1e7fb2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec34cfa2b08cc68e9d52e187b1e7fb2d">&#9670;&nbsp;</a></span>probToWeight()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::probToWeight </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prob_exp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>convert probability to weight for scoring </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>probability </td></tr>
    <tr><td class="paramname">exp_prob</td><td>background probability</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>In standard case, normlized log of probability; in case of mea, score_res*probability. </dd></dl>

</div>
</div>
<a id="a082d94ee94ec4ed47384ffe6da6a72c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a082d94ee94ec4ed47384ffe6da6a72c2">&#9670;&nbsp;</a></span>ribosum_arcmatch_prob()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double LocARNA::Scoring::ribosum_arcmatch_prob </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>arcA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>arcB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>returns probability of matching the concrete bases in an arcmatch, probability is based on ribosum data </p>

</div>
</div>
<a id="a7f0382b9935eb7ab18e2f68c7e3f5ff6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f0382b9935eb7ab18e2f68c7e3f5ff6">&#9670;&nbsp;</a></span>riboX_arcmatch_score()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::riboX_arcmatch_score </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>arcA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocARNA_1_1Scoring.html#a45b343536ae79ebbbb5016566eff8f65">Arc</a> &amp;&#160;</td>
          <td class="paramname"><em>arcB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ribofit or ribosum arcmatch score contribution </p>
<p>Sequence-based score contribution to match of the arcs due to ribofit matrix (if ribofit enabled) or ribosum matrix. The score contribution is calculated as sum-of-pairs; gaps and non-standard symbols (different from ACGU) are ignored!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arcA</td><td>arc A </td></tr>
    <tr><td class="paramname">arcB</td><td>arc B</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>score contribution </dd></dl>

</div>
</div>
<a id="ac5054144b392a5f661742bf4128a9989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5054144b392a5f661742bf4128a9989">&#9670;&nbsp;</a></span>round2score()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::round2score </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Round a double to score_t. </p>
<p>Proper rounding is more robust than truncate</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>score of type double </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>d rounded to integral type score_t </dd></dl>

</div>
</div>
<a id="a4e5078668841b2b90fc1d6313bc594db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e5078668841b2b90fc1d6313bc594db">&#9670;&nbsp;</a></span>sigma_()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::sigma_ </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute base similarity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>position in A </td></tr>
    <tr><td class="paramname">j</td><td>position in B</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>similarity of i and j </dd></dl>
<dl class="section note"><dt>Note</dt><dd>used for precomputing the score, which is then tabellized</dd></dl>
<p>returns similarity of two alignment columns </p>

</div>
</div>
<a id="a3130745838e4d1f9226064fed38e3c64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3130745838e4d1f9226064fed38e3c64">&#9670;&nbsp;</a></span>stacking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool LocARNA::Scoring::stacking </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Query stacking flag. </p>
<dl class="section return"><dt>Returns</dt><dd>flag, whether stacking is used (old or new stacking terms) </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a08273c9d48adaccb7fd46b3f2e34d977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08273c9d48adaccb7fd46b3f2e34d977">&#9670;&nbsp;</a></span>lambda_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLocARNA.html#ae4e0c4dfec0e83ac075b2e9a1e3746ea">score_t</a> LocARNA::Scoring::lambda_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>parameter for modified scoring in normalized local alignment </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/LocARNA/<a class="el" href="scoring_8hh_source.html">scoring.hh</a></li>
<li>src/LocARNA/scoring.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 19 2022 11:24:48 for LocARNA-2.0.0 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
